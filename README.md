# HyperFind

HyperFind is a GUI client application for performing search on non-indexed data in [OpenDiamond](http://diamond.cs.cmu.edu/) system. It is primarily designed to search images but can also be used for other data types.

## Install with Apt

Add the GPG key
```bash
wget -qO- http://diamond.cs.cmu.edu/packages/zf.key | sudo apt-key add -
```

Add the following line to file `/etc/apt/sources.list.d/opendiamond.list`:
```
deb http://diamond.cs.cmu.edu/packages <xenial|bionic> main
```
Choose your distribution accordingly. We currently support Ubuntu 16.04 (xenial) and 18.04 (bionic).

Finally,
```bash
sudo apt-get update
sudo apt-get install hyperfind
# Create directory used by hyperfind
mkdir -p $HOME/.diamond
# Start the GUI
hyperfind
```

HyperFind depends on `openjdk-8-jre`.


## Compile from Source

Install `openjdk-8-jdk` and `ant`.

Install `opendiamond.jar` following steps at [cmusatyalab/opendiamond-java](https://github.com/cmusatyalab/opendiamond-java)

Clone and compile:
```bash
git clone https://github.com/cmusatyalab/hyperfind.git
cd hyperfind
ant
# Create directory used by hyperfind
mkdir -p $HOME/.diamond
```

Start the GUI:
```bash
./hyperfind
```

## Other Artifacts for Running HyperFind

### ScopeCookie

`$HOME/.diamond/NEWSCOPE`: a [ScopeCookie](https://github.com/cmusatyalab/opendiamond/wiki/ScopeCookie) typically 
generated by a scope server or by the `cookiecutter` script from [OpenDiamond](http://diamond.cs.cmu.edu/). It contains information about the data set to be searched and the backend servers.

### Codecs, Predicates and Filters

HyperFind looks for these in the following directories:

+ `/usr/share/diamond/{codecs,predicates,filters}`
+ `/usr/local/share/diamond/{codecs,predicates,filters}`
+ `$HOME/.diamond/{codecs,predicates,filters}`

Typically, codecs/predicates/filters come in a bundle developed separately.

*For definitions of codec, predicate and filter, see https://github.com/cmusatyalab/opendiamond/wiki/StructureOfDiamond .*


## Tips

### Viewing ScopeCookie
[Recommended] If you have OpenDiamond installed locally:
```bash
python -m opendiamond.scope $HOME/.diamond/NEWSCOPE
```

The ScopeCookie is a base64-encoded string containing the authorized search servers, data sources and expiration time.

Alternative:
```bash
cat $HOME/.diamond/NEWSCOPE | grep -v \- | base64 -d
```

### Auto placing ScopeCookie (Linux Only)
Installing OpenDiamond on your computer will also install a system hook that automatically renames and places
the ScopeCookie properly when you double-click the downloaded file from the browser.

### Obtaining filters
The common type of downloadable filters (short for saying codecs/predicates/filters) is
a tar ball containing the directories `codecs/`, `predicates/` and `filters/`.
Decompress the tar ball and place files under `$HOME/.diamond/` as mentioned above.

### Running HyperFind remotely with X11 forwarding
It has been successful to run HyperFind in a Linux host and forward the GUI to Windows/MacOS.
To do so, you should enable X11 forwarding in your SSH connection and install a X11 server on your OS
(e.g., Xming on Windows, Xquartz on MacOS).

